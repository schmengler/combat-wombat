var _=Object.defineProperty,F=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var A=(t,n,r)=>n in t?_(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,T=(t,n)=>{for(var r in n||(n={}))G.call(n,r)&&A(t,r,n[r]);if(V)for(var r of V(n))K.call(n,r)&&A(t,r,n[r]);return t},P=(t,n)=>F(t,D(n));var b=(t,n,r)=>(A(t,typeof n!="symbol"?n+"":n,r),r);import{j as W,t as H,r as w,P as O,R as J,a as $}from"./vendor.f0d2a267.js";const q=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(o){if(o.ep)return;o.ep=!0;const s=r(o);fetch(o.href,s)}};q();var C;(function(t){t.None="keine Wunde",t.Muscle="Muskel",t.Sinew="Sehne",t.Bones="Knochen",t.Organ="Organ"})(C||(C={}));class S{constructor(){b(this,"value",0);b(this,"rounds",0);b(this,"woundType",C.None)}isEmpty(){return this.rounds==0}}const B=class{constructor(n,r){b(this,"id");b(this,"name");b(this,"ini");b(this,"hits",0);b(this,"bleeding",0);b(this,"boniOrMali",[]);b(this,"parryWithMali",[]);b(this,"noParryRounds",0);b(this,"dizzyRounds",0);b(this,"diesInRounds",0);b(this,"onGround",!1);b(this,"disarmed",!1);b(this,"conciousless",!1);b(this,"dead",!1);b(this,"notes","");this.id=B.nextId++,this.name=n,this.ini=r}turn(){function n(i){return i.map(o=>Object.assign(new S,o,{rounds:o.rounds-1})).filter(o=>o.rounds>0)}const r=Object.assign(new B("",0),this);return r.hits+=r.bleeding,r.noParryRounds=Math.max(0,r.noParryRounds-1),r.dizzyRounds=Math.max(0,r.dizzyRounds-1),r.diesInRounds=Math.max(0,r.diesInRounds-1),r.boniOrMali=n(r.boniOrMali),r.parryWithMali=n(r.parryWithMali),r.diesInRounds==0&&this.diesInRounds>0&&(r.dead=!0),r}canAct(){return!this.dead&&!this.conciousless}};let M=B;b(M,"nextId",1);const e=W.exports.jsx,g=W.exports.jsxs;H.exports.Simulate.input;function U({setCharacters:t}){return g("form",{onSubmit:r=>{r.preventDefault();const i=r.target.elements.namedItem("addText");if(i.value.trim()=="")return;const o=i.value.match(/^(?:(\d+) )?(.*?)(?: (\d+))?$/),s=Number.parseInt(o[1])||1,a=o[2],l=Number.parseInt(o[3])||0,c=Array.from({length:s},(u,f)=>new M(a+(s>1?" "+(f+1):""),l));t(u=>[...u,...c]),i.value=""},children:[e("svg",{className:"w-6 h-6 inline text-green-600",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e("path",{d:"M8 9a3 3 0 100-6 3 3 0 000 6zM8 11a6 6 0 016 6H2a6 6 0 016-6zM16 7a1 1 0 10-2 0v1h-1a1 1 0 100 2h1v1a1 1 0 102 0v-1h1a1 1 0 100-2h-1V7z"})}),e("input",{name:"addText",type:"text",className:"mx-2",placeholder:"[Anzahl] Name [Ini]"}),e("button",{type:"submit",className:"inline-block px-7 py-3 bg-amber-600 text-white font-bold text-xl leading-snug uppercase rounded shadow-md hover:bg-amber-700 hover:shadow-lg focus:bg-amber-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-amber-800 active:shadow-lg transition duration-150 ease-in-out",children:"Hinzuf\xFCgen"})]})}function Q({setCharacters:t,characterId:n}){return e("button",{onClick:()=>{t(i=>{const o=i.findIndex(s=>s.id==n);return i.filter((s,a)=>a!=o)})},children:e("svg",{className:"w-6 h-6 inline text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7a4 4 0 11-8 0 4 4 0 018 0zM9 14a6 6 0 00-6 6v1h12v-1a6 6 0 00-6-6zM21 12h-6"})})})}function X({entity:t,property:n,setEntity:r}){const i=w.exports.useRef(null),o=a=>{r(l=>Object.assign(Object.create(Object.getPrototypeOf(l)),P(T({},l),{[n]:a.target.elements[n].value}))),a.preventDefault()},s=()=>i.current.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0}));return e("form",{onSubmit:o,ref:i,children:e("input",{type:"text",name:n,defaultValue:t[n],className:"w-12",onBlur:s})})}function I({entity:t,property:n,setEntity:r,minValue:i=Number.MIN_SAFE_INTEGER,invertColors:o=!1,useBigSteps:s=!1}){const a=w.exports.useRef(null),l=w.exports.useRef(null),c=w.exports.useRef(null),[u,f]=w.exports.useState(!1);function h(y){r(R=>{const z=Object.assign(Object.create(Object.getPrototypeOf(R)),R);return z[n]=y(z[n]),z})}const p=(y=1)=>()=>{h(R=>Math.max(i,R+y)),d()},v=(y=1)=>()=>{h(R=>Math.max(i,R-y)),d()},k=y=>{h(()=>Math.max(i,Number.parseInt(y.target.value)))},d=()=>f(!0),m=function(){setTimeout(()=>{document.activeElement?f(c.current==document.activeElement.parentElement||l.current==document.activeElement.parentElement):f(!1)},10)},x=y=>y.key=="Enter"&&y.target.blur(),N="inline-block m-1 rounded-full bg-red-600 text-white leading-normal uppercase shadow-md hover:bg-red-700 hover:shadow-lg focus:bg-red-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-red-800 active:shadow-lg transition duration-150 ease-in-out w-9 h-9",E="inline-block m-1 rounded-full bg-green-600 text-white leading-normal uppercase shadow-md hover:bg-green-700 hover:shadow-lg focus:bg-green-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-green-800 active:shadow-lg transition duration-150 ease-in-out w-9 h-9";return e("div",{className:"custom-number-input h-full w-full",children:g("div",{ref:c,className:"flex flex-col h-full w-full rounded-lg relative bg-transparent mt-1 items-center",children:[e("button",{className:"bg-amber-100 text-amber-600 hover:text-amber-700 hover:bg-amber-200 h-full w-10 rounded-r cursor-pointer",onClick:p(),onBlur:m,children:e("span",{className:"m-auto text-2xl font-thin",children:"+"})}),e("input",{type:"number",ref:a,className:"outline-none focus:outline-none text-center w-10 bg-amber-100 font-semibold text-md hover:text-black focus:text-black  md:text-basecursor-default flex items-center text-amber-700  outline-none border-0 focus:ring-0 px-0 text-sm",value:t[n],onClick:d,onChange:k,onKeyPress:x,onBlur:m}),e("button",{className:" bg-amber-100 text-amber-600 hover:text-amber-700 hover:bg-amber-200 h-full w-10 rounded-l cursor-pointer outline-none",onClick:v(),onBlur:m,children:e("span",{className:"m-auto text-2xl font-thin",children:"\u2212"})}),g("div",{ref:l,hidden:!u||!s,className:"absolute bg-amber-100 left-full p-2 z-10 drop-shadow",children:[e("button",{className:o?E:N,onClick:p(10),onBlur:m,children:"+10"}),e("button",{className:o?E:N,onClick:p(100),onBlur:m,children:"+100"}),e("br",{}),e("button",{className:o?N:E,onClick:v(10),onBlur:m,children:"-10"}),e("button",{className:o?N:E,onClick:v(100),onBlur:m,children:"-100"})]})]})})}I.propTypes={property:O.string,minValue:O.number,invertColors:O.bool,useBigSteps:O.bool};function L({entity:t,property:n,setEntity:r,minValue:i=Number.MIN_SAFE_INTEGER,invertColors:o=!0,useWoundType:s=!1}){const[a,l]=w.exports.useState(!1),[c,u]=w.exports.useState(new S),f=d=>{u(m=>{const x=Object.assign(new S,m);return x.woundType=C[d.target.value],x})},h=d=>{r(m=>{if(c.isEmpty())return m;const x=Object.assign(new M("",0),m),N=Object.assign(new S,c);return u(new S),x[n]=[...x[n],N],l(!1),x})},p=d=>()=>r(m=>{const x=Object.assign(new M("",0),m);return x[n]=x[n].filter(N=>N!==d),x}),v=w.exports.useRef(null),k=()=>{l(!1)};return w.exports.useEffect(()=>{const d=m=>{v.current&&!v.current.contains(m.target)&&k&&k()};return document.addEventListener("click",d,!0),()=>{document.removeEventListener("click",d,!0)}},[k]),g("div",{className:"h-full w-full relative cursor-help",children:[e("div",{className:"h-full w-full text-2xl",onClick:()=>l(d=>!d),children:t[n].reduce((d,m)=>d+m.value,0)}),g("div",{ref:v,hidden:!a,className:"absolute bg-amber-100 top-10 p-2 z-10 drop-shadow text-left",children:[e("ol",{children:t[n].map(d=>g("li",{className:"text-xl",children:[e("button",{className:"inline-block text-orange-400",onClick:p(d),children:e("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),"\xA0",e("strong",{className:d.value>0?"text-green-600":"text-red-600",children:d.value}),"\xA0(",d.rounds,") \xA0",s&&e("strong",{children:d.woundType})]}))}),e("button",{className:"block px-7 py-3 bg-amber-600 text-white font-bold text-xl leading-snug uppercase rounded shadow-md hover:bg-amber-700 hover:shadow-lg focus:bg-amber-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-amber-800 active:shadow-lg transition duration-150 ease-in-out",onClick:h,children:e("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 11l7-7 7 7M5 19l7-7 7 7"})})}),g("table",{children:[e("thead",{children:g("tr",{children:[e("th",{className:"font-bold text-center",children:"Runden"}),e("th",{className:"font-bold text-center",children:"Bonus/Malus"})]})}),e("tbody",{children:g("tr",{children:[e("td",{children:e(I,{entity:c,setEntity:u,property:"rounds",minValue:0})}),e("td",{children:e(I,{entity:c,setEntity:u,property:"value",useBigSteps:!0,invertColors:o})})]})}),s&&e("fieldset",{children:Object.entries(C).map(d=>g("label",{className:"block py-2 cursor-pointer",children:[e("input",{name:"woundType",value:d[0],type:"radio",onChange:f,className:"text-amber-600 focus:ring-amber-400"})," ",d[1]]},d[0]))})]})]})]})}L.propTypes={property:O.string,minValue:O.number,invertColors:O.bool,useWoundType:O.bool};function j({entity:t,setEntity:n,property:r}){const i=o=>{n(s=>{const a=Object.assign(Object.create(Object.getPrototypeOf(s)),s);return a[r]=o.target.checked,a})};return e("div",{className:"w-full relative",children:g("label",{className:"select-none container block relative cursor-pointer text-xl pl-8 left-1/2 -ml-4",children:[e("input",{className:"absolute opacity-0 left-0 top-0 cursor-pointer",type:"checkbox",checked:t[r],onChange:i}),e("span",{className:"h-6 w-6 checkmark absolute top-0 left-0 bg-amber-100"})]})})}function Y({entity:t,property:n,setEntity:r}){const i=w.exports.useRef(null),o=a=>{r(l=>Object.assign(Object.create(Object.getPrototypeOf(l)),P(T({},l),{[n]:a.target.elements[n].value}))),a.preventDefault()},s=()=>i.current.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0}));return e("form",{onSubmit:o,ref:i,children:e("textarea",{name:n,defaultValue:t[n],className:"w-full",onBlur:s})})}function Z({tdClass:t,isEven:n,isCurrent:r,characters:i,setCharacters:o,characterId:s}){const a=i.findIndex(k=>k.id==s),l=i[a],c=k=>{o(d=>{const m=d.findIndex(N=>N.id==s),x=[...d];return x[m]=k(x[m]),x})},u="hover:bg-orange-50 dark:hover:bg-amber-700",f="bg-amber-50 hover:bg-orange-50 dark:hover:bg-amber-700",h=" bg-green-50",p=" bg-red-300 opacity-50",v=(n?f:u)+(r?h:"")+(l.canAct()?"":p);return g("tr",{className:v,"data-character-id":s,children:[g("td",{className:t+"overflow-hidden",children:[e(Q,{setCharacters:o,characterId:s}),e("div",{className:"inline-block font-bold text-lg -rotate-90",children:l.name})]}),e("td",{className:t,children:e(X,{entity:l,setEntity:c,property:"ini"})}),e("td",{className:t,children:e(I,{entity:l,setEntity:c,property:"hits",minValue:0,useBigSteps:!0})}),e("td",{className:t,children:e(I,{entity:l,setEntity:c,property:"bleeding",minValue:0})}),e("td",{className:t,children:e(L,{entity:l,setEntity:c,property:"boniOrMali",useWoundType:!0})}),e("td",{className:t,children:e(L,{entity:l,setEntity:c,property:"parryWithMali"})}),e("td",{className:t,children:e(I,{entity:l,setEntity:c,property:"noParryRounds",minValue:0})}),e("td",{className:t,children:e(I,{entity:l,setEntity:c,property:"dizzyRounds",minValue:0})}),e("td",{className:t,children:e(j,{entity:l,setEntity:c,property:"disarmed"})}),e("td",{className:t,children:e(j,{entity:l,setEntity:c,property:"onGround"})}),e("td",{className:t,children:e(j,{entity:l,setEntity:c,property:"conciousless"})}),e("td",{className:t,children:e(I,{entity:l,setEntity:c,property:"diesInRounds",minValue:0})}),e("td",{className:t,children:e(j,{entity:l,setEntity:c,property:"dead"})}),e("td",{className:t,children:e(Y,{entity:l,setEntity:c,property:"notes"})})]})}function ee({characters:t,setCharacters:n,currentId:r,setCurrentId:i,characterTable:o}){const s=u=>{n(f=>{const h=f.findIndex(v=>v.id==u),p=[...f];return p[h]=p[h].turn(),i(u),p[h].canAct()||s(p[(h+1)%p.length].id),p}),o.current.querySelector('tr[data-character-id="'+u+'"]').scrollIntoView({behavior:"smooth",block:"center"})};function a(){return r==null&&t.length>0?new M("Niemand",0):t.find(u=>u.id==r)||null}function l(){if(t.length==0)return;const f=(t.findIndex(h=>h.id==r)+1)%t.length;s(t[f].id)}const c=a();return c&&g("div",{className:"container mx-auto",children:[g("span",{className:"text-2xl px-6",children:["An der Reihe: ",e("span",{className:"font-bold",children:c.name})]}),e("button",{type:"button",className:"inline-block px-7 py-3 bg-amber-600 text-white font-bold text-xl leading-snug uppercase rounded shadow-md hover:bg-amber-700 hover:shadow-lg focus:bg-amber-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-amber-800 active:shadow-lg transition duration-150 ease-in-out",onClick:l,children:"N\xE4chster!"})]})}function te({characters:t,setCharacters:n,currentId:r,setCurrentId:i}){const o="min-w-full divide-y divide-amber-200 table-fixed dark:divide-amber-700 w-full",s="bg-amber-100 dark:bg-amber-700 w-full z-10 sticky top-0 drop-shadow",a="py-3 text-xs font-medium tracking-wider text-left text-amber-700 uppercase dark:text-amber-400 sm:-rotate-90 xl:rotate-0 sm:px-1 xl:px-6",l="bg-white divide-y divide-amber-200 dark:bg-amber-800 dark:divide-amber-700",c="bottom-0 sticky bg-white/80",u=w.exports.useRef(null),f="py-1 text-sm font-medium text-amber-900 whitespace-nowrap dark:text-white sm:px-1 xl:px-6 align-middle text-center border-dotted border-x border-amber-600";return t.sort((h,p)=>p.ini-h.ini),g("table",{className:o,children:[e("thead",{className:s,children:g("tr",{children:[e("th",{scope:"col",className:a,children:"Chara"}),e("th",{scope:"col",className:a,children:"Ini"}),e("th",{scope:"col",className:a,children:"Treffer"}),e("th",{scope:"col",className:a,children:"Blutung / Runde"}),e("th",{scope:"col",className:a,children:"Boni/Mali"}),e("th",{scope:"col",className:a,children:"Muss mit ___ parieren"}),e("th",{scope:"col",className:a,children:"Runden Keine Parade"}),e("th",{scope:"col",className:a,children:"Runden Benommen"}),e("th",{scope:"col",className:a,children:"Entwaffnet"}),e("th",{scope:"col",className:a,children:"Am Boden"}),e("th",{scope:"col",className:a,children:"Bewusstlos"}),e("th",{scope:"col",className:a,children:"stirbt in __ Runden"}),e("th",{scope:"col",className:a,children:"tot"}),e("th",{scope:"col",className:a,children:"Notizen"})]})}),e("tbody",{className:l,ref:u,children:t.map((h,p)=>e(Z,{tdClass:f,isCurrent:r==h.id,isEven:p%2==0,characters:t,setCharacters:n,characterId:h.id},h.id))}),e("tfoot",{className:c,children:g("tr",{children:[e("td",{className:f,colSpan:7,children:e(U,{setCharacters:n})}),e("td",{className:f,colSpan:7,children:e(ee,{characters:t,characterTable:u,setCharacters:n,currentId:r,setCurrentId:i})})]})})]})}function ne(){function t(){return JSON.parse(localStorage.getItem("characters")||"[]").map(l=>Object.assign(new M("",0),l))}function n(){return Number.parseInt(localStorage.getItem("currentId")||"")||null}function r(){localStorage.setItem("characters",JSON.stringify(s)),localStorage.setItem("currentId",JSON.stringify(i))}const[i,o]=w.exports.useState(n()),[s,a]=w.exports.useState(t());return w.exports.useEffect(r,[s]),e("div",{className:"App",children:e(te,{characters:s,setCharacters:a,currentId:i,setCurrentId:o})})}J.render(e($.StrictMode,{children:e(ne,{})}),document.getElementById("root"));
