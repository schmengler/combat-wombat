var D=Object.defineProperty,G=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable;var z=(n,t,r)=>t in n?D(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,A=(n,t)=>{for(var r in t||(t={}))H.call(t,r)&&z(n,r,t[r]);if(V)for(var r of V(t))_.call(t,r)&&z(n,r,t[r]);return n},P=(n,t)=>G(n,K(t));var m=(n,t,r)=>(z(n,typeof t!="symbol"?t+"":t,r),r);import{j as F,t as J,r as N,P as R,R as $,a as q}from"./vendor.f0d2a267.js";const U=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}};U();var E;(function(n){n.None="keine Wunde",n.Muscle="Muskel",n.Sinew="Sehne",n.Bones="Knochen",n.Organ="Organ"})(E||(E={}));class B{constructor(t){m(this,"characterId");m(this,"value",0);m(this,"rounds",0);m(this,"woundType",E.None);m(this,"inflictedByCharacterId",null);m(this,"fresh",!0);this.characterId=t}isEmpty(){return this.rounds==0}isInflictedBy(t){return t.id==this.inflictedByCharacterId}withRounds(t){return Object.assign(this,{rounds:this.rounds+t})}static clone(t){return Object.assign(new B(t.characterId),t)}withFresh(t){return Object.assign(this,{fresh:t})}isNotFresh(){return!this.fresh}}const j=class{constructor(t,r){m(this,"id");m(this,"name");m(this,"ini");m(this,"hits",0);m(this,"bleeding",0);m(this,"boniOrMali",[]);m(this,"parryWithMali",[]);m(this,"noParryRounds",0);m(this,"dizzyRounds",0);m(this,"diesInRounds",0);m(this,"onGround",!1);m(this,"disarmed",!1);m(this,"consciousness",!1);m(this,"dead",!1);m(this,"notes","");this.id=j.nextId++,this.name=t,this.ini=r}turnModifiers(t,r){return t.map(s=>B.clone(s)).map(s=>s.isInflictedBy(r)&&s.isNotFresh()?s.withRounds(-1):s).map(s=>s.withFresh(!1)).filter(s=>s.rounds>0)}beforeTurn(t){const r=j.clone(this);return t.filter(s=>s.id!==r.id).forEach(s=>{s.boniOrMali=this.turnModifiers(s.boniOrMali,r),s.parryWithMali=this.turnModifiers(s.parryWithMali,r)}),r.noParryRounds=Math.max(0,r.noParryRounds-1),r.dizzyRounds=Math.max(0,r.dizzyRounds-1),r.hits+=r.bleeding,r.diesInRounds=Math.max(0,r.diesInRounds-1),r.diesInRounds==0&&this.diesInRounds>0&&(r.dead=!0),r}afterTurn(){const t=j.clone(this);return t.boniOrMali=this.turnModifiers(t.boniOrMali,t),t}canAct(){return!this.dead&&!this.consciousness}static clone(t){return Object.assign(new j("",0),t)}};let C=j;m(C,"nextId",1);const e=F.exports.jsx,p=F.exports.jsxs;J.exports.Simulate.input;function Q({setCharacters:n}){return p("form",{onSubmit:r=>{r.preventDefault();const s=r.target.elements.namedItem("addText");if(s.value.trim()=="")return;const o=s.value.match(/^(?:(\d+) )?(.*?)(?: (\d+))?$/),i=Number.parseInt(o[1])||1,a=o[2],f=Number.parseInt(o[3])||0,d=Array.from({length:i},(l,b)=>new C(a+(i>1?" "+(b+1):""),f));n(l=>[...l,...d]),s.value=""},children:[e("svg",{className:"w-6 h-6 inline text-green-600",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e("path",{d:"M8 9a3 3 0 100-6 3 3 0 000 6zM8 11a6 6 0 016 6H2a6 6 0 016-6zM16 7a1 1 0 10-2 0v1h-1a1 1 0 100 2h1v1a1 1 0 102 0v-1h1a1 1 0 100-2h-1V7z"})}),e("input",{name:"addText",type:"text",className:"mx-2",placeholder:"[Anzahl] Name [Ini]"}),e("button",{type:"submit",className:"inline-block px-7 py-3 bg-amber-600 text-white font-bold text-xl leading-snug uppercase rounded shadow-md hover:bg-amber-700 hover:shadow-lg focus:bg-amber-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-amber-800 active:shadow-lg transition duration-150 ease-in-out",children:"Hinzuf\xFCgen"})]})}function X({setCharacters:n,characterId:t}){return e("button",{onClick:()=>{n(s=>{const o=s.findIndex(i=>i.id==t);return s.filter((i,a)=>a!=o)})},children:e("svg",{className:"w-6 h-6 inline text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7a4 4 0 11-8 0 4 4 0 018 0zM9 14a6 6 0 00-6 6v1h12v-1a6 6 0 00-6-6zM21 12h-6"})})})}function Y({entity:n,property:t,setEntity:r}){const s=N.exports.useRef(null),o=a=>{r(f=>Object.assign(Object.create(Object.getPrototypeOf(f)),P(A({},f),{[t]:a.target.elements[t].value}))),a.preventDefault()},i=()=>s.current.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0}));return e("form",{onSubmit:o,ref:s,children:e("input",{type:"text",name:t,defaultValue:n[t],className:"w-12",onBlur:i})})}function S({entity:n,property:t,setEntity:r,minValue:s=Number.MIN_SAFE_INTEGER,invertColors:o=!1,useBigSteps:i=!1}){const a=N.exports.useRef(null),f=N.exports.useRef(null),d=N.exports.useRef(null),[l,b]=N.exports.useState(!1);function u(h){r(x=>{const M=Object.assign(Object.create(Object.getPrototypeOf(x)),x);return M[t]=h(M[t]),M})}const g=(h=1)=>()=>{u(x=>Math.max(s,x+h)),v()},y=(h=1)=>()=>{u(x=>Math.max(s,x-h)),v()},w=h=>{u(()=>Math.max(s,Number.parseInt(h.target.value)))},v=()=>b(!0),k=function(){setTimeout(()=>{document.activeElement?b(d.current==document.activeElement.parentElement||f.current==document.activeElement.parentElement):b(!1)},10)},O=h=>h.key=="Enter"&&h.target.blur(),I="inline-block m-1 rounded-full bg-red-600 text-white leading-normal uppercase shadow-md hover:bg-red-700 hover:shadow-lg focus:bg-red-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-red-800 active:shadow-lg transition duration-150 ease-in-out w-9 h-9",c="inline-block m-1 rounded-full bg-green-600 text-white leading-normal uppercase shadow-md hover:bg-green-700 hover:shadow-lg focus:bg-green-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-green-800 active:shadow-lg transition duration-150 ease-in-out w-9 h-9";return e("div",{className:"custom-number-input h-full w-full",children:p("div",{ref:d,className:"flex flex-col h-full w-full rounded-lg relative bg-transparent mt-1 items-center",children:[e("button",{className:"bg-amber-100 text-amber-600 hover:text-amber-700 hover:bg-amber-200 h-full w-10 rounded-r cursor-pointer",onClick:g(),onBlur:k,children:e("span",{className:"m-auto text-2xl font-thin",children:"+"})}),e("input",{type:"number",ref:a,className:"outline-none focus:outline-none text-center w-10 bg-amber-100 font-semibold text-md hover:text-black focus:text-black  md:text-basecursor-default flex items-center text-amber-700  outline-none border-0 focus:ring-0 px-0 text-sm",value:n[t],onClick:v,onChange:w,onKeyPress:O,onBlur:k}),e("button",{className:" bg-amber-100 text-amber-600 hover:text-amber-700 hover:bg-amber-200 h-full w-10 rounded-l cursor-pointer outline-none",onClick:y(),onBlur:k,children:e("span",{className:"m-auto text-2xl font-thin",children:"\u2212"})}),p("div",{ref:f,hidden:!l||!i,className:"absolute bg-amber-100 left-full p-2 z-10 drop-shadow",children:[e("button",{className:o?c:I,onClick:g(10),onBlur:k,children:"+10"}),e("button",{className:o?c:I,onClick:g(100),onBlur:k,children:"+100"}),e("br",{}),e("button",{className:o?I:c,onClick:y(10),onBlur:k,children:"-10"}),e("button",{className:o?I:c,onClick:y(100),onBlur:k,children:"-100"})]})]})})}S.propTypes={property:R.string,minValue:R.number,invertColors:R.bool,useBigSteps:R.bool};function L({entity:n,property:t,setEntity:r,characters:s,currentId:o,minValue:i=Number.MIN_SAFE_INTEGER,invertColors:a=!0,useWoundType:f=!1}){const d=n.id,[l,b]=N.exports.useState(!1),[u,g]=N.exports.useState(new B(d));function y(){return o==null&&s.length>0?n:s.find(c=>c.id==o)||n}const w=c=>{g(h=>{const x=Object.assign(new B(d),h);return x.woundType=E[c.target.value],x})},v=c=>{r(h=>{if(u.isEmpty())return h;const x=Object.assign(new C("",0),h),M=Object.assign(new B(d),u),W=y();return M.inflictedByCharacterId=W.id,g(new B(d)),x[t]=[...x[t],M],b(!1),x})},k=c=>()=>r(h=>{const x=Object.assign(new C("",0),h);return x[t]=x[t].filter(M=>M!==c),x}),O=N.exports.useRef(null),I=()=>{b(!1)};return N.exports.useEffect(()=>{const c=h=>{O.current&&!O.current.contains(h.target)&&I&&I()};return document.addEventListener("click",c,!0),()=>{document.removeEventListener("click",c,!0)}},[I]),p("div",{className:"h-full w-full relative cursor-help",children:[e("div",{className:"h-full w-full text-2xl",onClick:()=>b(c=>!c),children:n[t].reduce((c,h)=>c+h.value,0)}),p("div",{ref:O,hidden:!l,className:"absolute bg-amber-100 top-10 p-2 z-10 drop-shadow text-left",children:[e("ol",{children:n[t].map((c,h)=>p("li",{className:"text-xl",children:[e("button",{className:"inline-block text-orange-400",onClick:k(c),children:e("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),"\xA0",e("strong",{className:c.value>0?"text-green-600":"text-red-600",children:c.value}),"\xA0(",c.rounds,") \xA0",f&&e("strong",{children:c.woundType})]},h))}),e("button",{className:"block px-7 py-3 bg-amber-600 text-white font-bold text-xl leading-snug uppercase rounded shadow-md hover:bg-amber-700 hover:shadow-lg focus:bg-amber-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-amber-800 active:shadow-lg transition duration-150 ease-in-out",onClick:v,children:e("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 11l7-7 7 7M5 19l7-7 7 7"})})}),p("table",{children:[e("thead",{children:p("tr",{children:[e("th",{className:"font-bold text-center",children:"Runden"}),e("th",{className:"font-bold text-center",children:"Bonus/Malus"})]})}),p("tbody",{children:[p("tr",{children:[e("td",{children:e(S,{entity:u,setEntity:g,property:"rounds",minValue:0})}),e("td",{children:e(S,{entity:u,setEntity:g,property:"value",useBigSteps:!0,invertColors:a})})]}),f&&e("tr",{children:e("td",{colSpan:2,children:e("fieldset",{children:Object.entries(E).map(c=>p("label",{className:"block py-2 cursor-pointer",children:[e("input",{name:"woundType",value:c[0],type:"radio",onChange:w,className:"text-amber-600 focus:ring-amber-400"})," ",c[1]]},c[0]))})})})]})]})]})]})}L.propTypes={property:R.string,minValue:R.number,invertColors:R.bool,useWoundType:R.bool};function T({entity:n,setEntity:t,property:r}){const s=o=>{t(i=>{const a=Object.assign(Object.create(Object.getPrototypeOf(i)),i);return a[r]=o.target.checked,a})};return e("div",{className:"w-full relative",children:p("label",{className:"select-none container block relative cursor-pointer text-xl pl-8 left-1/2 -ml-4",children:[e("input",{className:"absolute opacity-0 left-0 top-0 cursor-pointer",type:"checkbox",checked:n[r],onChange:s}),e("span",{className:"h-6 w-6 checkmark absolute top-0 left-0 bg-amber-100"})]})})}function Z({entity:n,property:t,setEntity:r}){const s=N.exports.useRef(null),o=a=>{r(f=>Object.assign(Object.create(Object.getPrototypeOf(f)),P(A({},f),{[t]:a.target.elements[t].value}))),a.preventDefault()},i=()=>s.current.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0}));return e("form",{onSubmit:o,ref:s,children:e("textarea",{name:t,defaultValue:n[t],className:"w-full",onBlur:i})})}function ee({tdClass:n,isEven:t,isCurrent:r,currentId:s,characters:o,setCharacters:i,characterId:a}){const f=o.findIndex(v=>v.id==a),d=o[f],l=v=>{i(k=>{const O=k.findIndex(c=>c.id==a),I=[...k];return I[O]=v(I[O]),I})},b="hover:bg-orange-50 dark:hover:bg-amber-700",u="bg-amber-50 hover:bg-orange-50 dark:hover:bg-amber-700",g=" bg-green-50",y=" bg-red-300 opacity-50",w=(t?u:b)+(r?g:"")+(d.canAct()?"":y);return p("tr",{className:w,"data-character-id":a,children:[p("td",{className:n+"overflow-hidden",children:[e(X,{setCharacters:i,characterId:a}),e("div",{className:"inline-block font-bold text-lg -rotate-90",children:d.name})]}),e("td",{className:n,children:e(Y,{entity:d,setEntity:l,property:"ini"})}),e("td",{className:n,children:e(S,{entity:d,setEntity:l,property:"hits",minValue:0,useBigSteps:!0})}),e("td",{className:n,children:e(S,{entity:d,setEntity:l,property:"bleeding",minValue:0})}),e("td",{className:n,children:e(L,{entity:d,characters:o,currentId:s,setEntity:l,property:"boniOrMali",useWoundType:!0})}),e("td",{className:n,children:e(L,{entity:d,characters:o,currentId:s,setEntity:l,property:"parryWithMali"})}),e("td",{className:n,children:e(S,{entity:d,setEntity:l,property:"noParryRounds",minValue:0})}),e("td",{className:n,children:e(S,{entity:d,setEntity:l,property:"dizzyRounds",minValue:0})}),e("td",{className:n,children:e(T,{entity:d,setEntity:l,property:"disarmed"})}),e("td",{className:n,children:e(T,{entity:d,setEntity:l,property:"onGround"})}),e("td",{className:n,children:e(T,{entity:d,setEntity:l,property:"consciousness"})}),e("td",{className:n,children:e(S,{entity:d,setEntity:l,property:"diesInRounds",minValue:0})}),e("td",{className:n,children:e(T,{entity:d,setEntity:l,property:"dead"})}),e("td",{className:n,children:e(Z,{entity:d,setEntity:l,property:"notes"})})]})}function te({characters:n,setCharacters:t,currentId:r,setCurrentId:s,characterTable:o}){const i=(l,b)=>{t(u=>{const g=u.findIndex(v=>v.id==b),y=u.findIndex(v=>v.id==l),w=[...u];return w[g]&&(w[g]=w[g].afterTurn()),w[y]=w[y].beforeTurn(u),s(l),w[y].canAct()||i(w[(y+1)%w.length].id,l),w}),o.current.querySelector('tr[data-character-id="'+l+'"]').scrollIntoView({behavior:"smooth",block:"center"})};function a(){return r==null&&n.length>0?new C("Niemand",0):n.find(l=>l.id==r)||new C("Niemand",0)}function f(){if(n.length==0)return;const b=(n.findIndex(u=>u.id==r)+1)%n.length;i(n[b].id,r)}const d=a();return p("div",{className:"container mx-auto",children:[p("span",{className:"text-2xl px-6",children:["An der Reihe: ",e("span",{className:"font-bold",children:d.name})]}),e("button",{type:"button",className:"inline-block px-7 py-3 bg-amber-600 text-white font-bold text-xl leading-snug uppercase rounded shadow-md hover:bg-amber-700 hover:shadow-lg focus:bg-amber-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-amber-800 active:shadow-lg transition duration-150 ease-in-out",onClick:f,children:"N\xE4chster!"})]})}function ne({characters:n,setCharacters:t,currentId:r,setCurrentId:s}){const o="min-w-full divide-y divide-amber-200 table-fixed dark:divide-amber-700 w-full",i="bg-amber-100 dark:bg-amber-700 w-full z-10 sticky top-0 drop-shadow",a="py-3 text-xs font-medium tracking-wider text-left text-amber-700 uppercase dark:text-amber-400 sm:-rotate-90 xl:rotate-0 sm:px-1 xl:px-6",f="bg-white divide-y divide-amber-200 dark:bg-amber-800 dark:divide-amber-700",d="bottom-0 sticky bg-white/80",l=N.exports.useRef(null),b="py-1 text-sm font-medium text-amber-900 whitespace-nowrap dark:text-white sm:px-1 xl:px-6 align-middle text-center border-dotted border-x border-amber-600";return n.sort((u,g)=>g.ini-u.ini),p("table",{className:o,children:[e("thead",{className:i,children:p("tr",{children:[e("th",{scope:"col",className:a,children:"Chara"}),e("th",{scope:"col",className:a,children:"Ini"}),e("th",{scope:"col",className:a,children:"Treffer"}),e("th",{scope:"col",className:a,children:"Blutung / Runde"}),e("th",{scope:"col",className:a,children:"Boni/Mali"}),e("th",{scope:"col",className:a,children:"Muss mit ___ parieren"}),e("th",{scope:"col",className:a,children:"Runden Keine Parade"}),e("th",{scope:"col",className:a,children:"Runden Benommen"}),e("th",{scope:"col",className:a,children:"Entwaffnet"}),e("th",{scope:"col",className:a,children:"Am Boden"}),e("th",{scope:"col",className:a,children:"Bewusstlos"}),e("th",{scope:"col",className:a,children:"stirbt in __ Runden"}),e("th",{scope:"col",className:a,children:"tot"}),e("th",{scope:"col",className:a,children:"Notizen"})]})}),e("tbody",{className:f,ref:l,children:n.map((u,g)=>e(ee,{tdClass:b,isCurrent:r==u.id,currentId:r,isEven:g%2==0,characters:n,setCharacters:t,characterId:u.id},u.id))}),e("tfoot",{className:d,children:p("tr",{children:[e("td",{className:b,colSpan:7,children:e(Q,{setCharacters:t})}),e("td",{className:b,colSpan:7,children:e(te,{characters:n,characterTable:l,setCharacters:t,currentId:r,setCurrentId:s})})]})})]})}function re(){function n(){return JSON.parse(localStorage.getItem("characters")||"[]").map(f=>Object.assign(new C("",0),f))}function t(){return Number.parseInt(localStorage.getItem("currentId")||"")||null}function r(){localStorage.setItem("characters",JSON.stringify(i)),localStorage.setItem("currentId",JSON.stringify(s))}const[s,o]=N.exports.useState(t()),[i,a]=N.exports.useState(n());return N.exports.useEffect(r,[i]),e("div",{className:"App",children:e(ne,{characters:i,setCharacters:a,currentId:s,setCurrentId:o})})}$.render(e(q.StrictMode,{children:e(re,{})}),document.getElementById("root"));
